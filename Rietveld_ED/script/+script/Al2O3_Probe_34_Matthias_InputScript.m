%% Choice of scattering angle TwoTheta
config.configParameter('TwoTheta',...
	'Value', 11);

psiTmp = [0;4;8;12;16;20;24;28;32;36;40;46;52;58;64;70;73;76;78;80;81;82;83;84;85;86;87;88;88.5];
for i = 1:numberOfSpecs
	config.configParameter('Psi',...
		'Value', psiTmp(i),...
		'SpecIndex', i);
end

%% Input of photon energies of principal K-, L-shell emmision lines
config.configParameter('FluorPos_K',...
	'Value', zeros(0,1));
config.configParameter('FluorPos_L',...
	'Value', zeros(0,1));
config.configParameter('FluorInt_K',...
	'Value', zeros(0,1));
config.configParameter('FluorInt_L',...
	'Value', zeros(0,1));

%% Input of the h k l values and multiplicity m values
hklTmp = [0 1 2 6;...
        1 0 4 6;...
        1 1 0 6;...
        0 0 6 2;...
        1 1 3 12;...
        2 0 2 6;...
        0 2 4 6;...
        1 1 6 12;...
        2 1 1 12;...
        1 2 2 12;...
        0 1 8 6;...
        2 1 4 12;...
        3 0 0 6;...
        1 2 5 12;...
        2 0 8 6;...
        1 0 10 6;...
        1 1 9 12;...
%         2 1 7 12;...
        2 2 0 6;...
%         0 3 6 6;...
        3 0 6 6;...
        2 2 3 12;...
        1 3 1 12;...
        3 1 2 12;...
        1 2 8 12;...
        0 2 10 6;...
        0 0 12 2;...
        1 3 4 12;...
%         3 1 5 12;...
        2 2 6 12;...
		0 4 2 6;...
		2 1 10 12];...
% 		1 1 12 12;...
% 		4 0 4 6;...
% 		3 2 1 12;...
% 		1 2 11 12;...
% 		3 1 8 12;...
% 		2 2 9 12;...
% 		3 2 4 12;...
% 		0 1 14 6;...
% 		4 1 0 12;...
% 		2 3 5 12;...
% 		4 1 3 12;...
% 		0 4 8 6;...
% 		1 3 10 12];
config.configParameter('H',...
	'Value', hklTmp(:,1));
config.configParameter('K',...
	'Value', hklTmp(:,2));
config.configParameter('L',...
	'Value', hklTmp(:,3));
config.configParameter('Multiplicity',...
	'Value', hklTmp(:,4));
config.configParameter('Alpha',...
	'Value', 90);
config.configParameter('Beta',...
	'Value', 90);
config.configParameter('Gamma',...
	'Value', 120);
ringCurrentTmp = [268.571;251.497;241.24;231.519;226.941;222.55;221.469;...
	220.405;219.346;218.303;217.272;216.263;215.268;214.274;213.297;...
	212.321;211.365;210.419;209.48 ;208.554;207.637;206.726;205.826;...
	204.937;204.047;203.171;202.307;201.439;200.584];
for i = 1:numberOfSpecs
	config.configParameter('RingCurrent',...
		'Value', ringCurrentTmp(i),...
		'SpecIndex', i);
end
deadTimeTmp = [4.225;4.28;4.335;4.12;3.91;3.64;3.555;3.375;3.205;3.035;...
	2.915;2.745;2.43;2;1.64;1.315;1.175;1.025;0.935;0.845;0.815;0.76;...
	0.7;0.67;0.615;0.57;0.525;0.475;0.425];
for i = 1:numberOfSpecs
	config.configParameter('DeadTime',...
		'Value', deadTimeTmp(i),...
		'SpecIndex', i);
end

%% Input of the DEK values
DEK_S_Tmp = [-6.845E-007 +3.364E-006
		-5.622E-007 +3.022E-006
		-5.568E-007 +2.959E-006
		-4.747E-007 +2.789E-006
		-6.098E-007 +3.135E-006
		-5.272E-007 +2.877E-006
		-6.845E-007 +3.364E-006
		-6.121E-007 +3.167E-006
		-5.479E-007 +2.933E-006
		-5.977E-007 +3.086E-006
		-5.425E-007	+2.982E-006
		-5.666E-007 +3.002E-006
		-5.568E-007 +2.959E-006
		-6.509E-007 +3.261E-006
		-5.622E-007 +3.022E-006
		-5.099E-007 +2.888E-006
		-5.763E-007 +3.073E-006
		-5.568E-007 +2.959E-006
		-5.475E-007 +2.953E-006
		-5.774E-007 +3.026E-006
		-5.730E-007	+3.008E-006
		-5.398E-007 +2.910E-006
		-6.482E-007 +3.270E-006
		-6.076E-007 +3.166E-006
		-4.747E-007 +2.789E-006
		-6.316E-007 +3.191E-006
		-6.098E-007 +3.135E-006
		-5.965E-007 +3.080E-006
		-5.831E-007 +3.083E-006];
config.configParameter('DEK_S1',...
	'Value', DEK_S_Tmp(:,1));
config.configParameter('DEK_S2',...
	'Value', DEK_S_Tmp(:,2));

%% Input of the attenuation factors
config.configParameter('DensityAir',...
	'Value', 1.293e-003);
load(fullfile(rvpath,'data','Physics','Air_Absorption.mat'));
config.configParameter('X_airabsorption',...
	'Value', X_airabsorption);
config.configParameter('Y_airabsorption',...
	'Value', Y_airabsorption_en);
config.configParameter('DetectorDistance',...
	'Value', 110);

%% material absorption correction
config.configParameter('Density',...
	'Value', 4.00);
load(fullfile(rvpath,'data','Physics','Al2O3_absorption_XCOM'));
config.configParameter('X_abs',...
	'Value', X_abs);
config.configParameter('Y_abs',...
	'Value', Y_abs);

%% structure factor calculation
load(fullfile(rvpath,'data','Physics','AtomSF.mat'));
config.configParameter('SF_a',...
	'Value', [Atomdata(21,[1 3 5 7]); Atomdata(12,[1 3 5 7])]);
config.configParameter('SF_b',...
	'Value', [Atomdata(21,[2 4 6 8]); Atomdata(12,[2 4 6 8])]);
config.configParameter('SF_c',...
	'Value', [Atomdata(21,9); Atomdata(12,9)]);
config.configParameter('APConst',...
	'Value', [0 0 0.35;...
            2/3 1/3 0.68333;...
            1/3 2/3 0.016666;...
            0 0 0.85;...
            2/3 1/3 0.48333;...
            1/3 2/3 0.81666;...
            0 0 -0.35;...
            2/3 1/3 -0.01666;...
            1/3 2/3 0.31666;...
            0 0 0.85;...
            2/3 1/3 0.18333;...
            1/3 2/3 0.51667;...
			%
			0.3 0 1/4;...
            0.96666 1/3 1/4+1/3;...
            0.63333 2/3 1/4+2/3;...
            0 0.3 1/4;...
            2/3 0.63333 1/4+1/3;...
            1/3 0.96666 1/4+2/3;...
            -0.3 -0.3 1/4;...
            0.36666 0.03333 1/4+1/3;...
            0.03333 0.36666 1/4+2/3;...
            -0.3 0 3/4;...
            0.36666 1/3 3/4+1/3;...
            0.03333 2/3 3/4+2/3;...
            0 -0.3 3/4;...
            2/3 0.03333 3/4+1/3;...
            1/3 0.36666 3/4+2/3;...
            0.3 0.3 3/4;...
            0.96666 0.63333 3/4+1/3;...
            0.63333 0.96666 3/4+2/3]);
config.configParameter('APFitPattern',...
	'Value', [0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			%
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0;...
			0 0 0]);
% 		'Value', [0 0 1;...
% 			0 0 1;...
% 			0 0 1;...
% 			0 0 -1;...
% 			0 0 -1;...
% 			0 0 -1;...
% 			0 0 -1;...
% 			0 0 -1;...
% 			0 0 -1;...
% 			0 0 1;...
% 			0 0 1;...
% 			0 0 1;...
% 			%
% 			1 0 0;...
% 			1 0 0;...
% 			1 0 0;...
% 			0 1 0;...
% 			0 1 0;...
% 			0 1 0;...
% 			-1 -1 0;...
% 			-1 -1 0;...
% 			-1 -1 0;...
% 			-1 0 0;...
% 			-1 0 0;...
% 			-1 0 0;...
% 			0 -1 0;...
% 			0 -1 0;...
% 			0 -1 0;...
% 			1 1 0;...
% 			1 1 0;...
% 			1 1 0]);
config.configParameter('APFitParams',...
	'Value', 0);
config.configParameter('AtomCoordCnts',...
	'Value', [12; 18]);

%% FitParameter for the FWHM and the line position calibration
config.configParameter('FluorScaleFactor_K',...
	'Value', 1,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorScaleFactor_L',...
	'Value', 1,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorDeltaEnergy_K',...
	'Value', zeros(3,1),...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorDeltaEnergy_L',...
	'Value', zeros(3,1),...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorU_K',...
	'Value', 0.0025,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorW_K',...
	'Value', 0.0005,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorU_L',...
	'Value', 0.0025,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorW_L',...
	'Value', 0.0005,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);

%% Escape peaks
% config.configParameter('EscapeInt_Alpha',...
% 	'Value', ones(4,1));
% config.configParameter('EscapeInt_Beta',...
% 	'Value', ones(4,1));
% config.configParameter('EscapeAlphaInd',...
% 	'Value', [1; 2; 3; 4]);
% config.configParameter('EscapeBetaInd',...
% 	'Value', [1; 2; 3; 4]);
% config.configParameter('EscapeScaleFactor_Alpha',...
% 	'Value', 1,...
% 	'LowerConstraint', 0,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeScaleFactor_Beta',...
% 	'Value', 1,...
% 	'LowerConstraint', 0,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeU_Alpha',...
% 	'Value', 0.0025,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeU_Beta',...
% 	'Value', 0.0005,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeW_Alpha',...
% 	'Value', 0.0025,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeW_Beta',...
% 	'Value', 0.0005,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);

%% Phase
config.configParameter('ScaleFactor',...
	'Value', 1,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', true);
config.configParameter('StructureFactor',...
	'Value', ones(13,1).*5000,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('DeltaEnergy_a',...
	'Value', -0.0251,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('DeltaEnergy_b',...
	'Value',  0.0023,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('DeltaEnergy_c',...
	'Value', -2.9196e-005,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('LatticeParam1',...
	'Value', 4.759397,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('LatticeParam2',...
	'Value', 0,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('LatticeParam3',...
	'Value', 12.99237,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
% config.configParameter('StressCoef',...
% 	'Value', [0; 0; 0],...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
config.configParameter('StressCoef1',...
	'Value', 0,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('StressCoef2',...
	'Value', 0,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('StressCoef3',...
	'Value', 0,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
% config.configParameter('StressCoef4',...
% 	'Value', 0,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('StressCoef5',...
% 	'Value', 0,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);

PSizeTmp = [0.0502928865;0.0498907988;0.0504895377;0.0495272217;0.0487393871;0.0486391966;0.0485535861;0.0475523511;0.0468201169;0.0489410876;0.0470994856;0.0468071748;0.0479947134;0.0472882594;0.0482531857;0.0471924482;0.0486939457;0.0483344581;0.0485821592;0.0477572414;0.0503000437;0.0450846423;0.0441425616;0.043643791;0.0507783288;0.0518942437;0.0475628654;0.0508105503;0.0512451474;0.0458585678;0.0484452338;0.0409205604];
for i = 1:numberOfSpecs
	config.configParameter('P_Size',...
		'Value', PSizeTmp(i),...
		'LowerConstraint', PSizeTmp(i),...
		'UpperConstraint', 1,...
		'Refinable', false,...
		'SpecIndex', i);
end
UStrainTmp = [0.0000257645;0.0000257301;0.0000259809;0.0000253704;0.0000251227;0.0000277232;0.0000254381;0.0000274357;0.0000257977;0.0000245641;0.0000240903;0.0000267191;0.0000241597;0.0000277264;0.0000259894;0.0000274317;0.0000297916;0.0000259695;0.0000280215;0.0000275548;0.0000283319;0.0000289938;0.0000283309;0.0000308131;0.0000309039;0.0000247043;0.000032232;0.0000249644;0.0000259018;0.000035828;0.0000349414;0.0000357355];
for i = 1:numberOfSpecs
	config.configParameter('U_Strain',...
		'Value', UStrainTmp(i),...
		'LowerConstraint', UStrainTmp(i),...
		'UpperConstraint', 1,...
		'Refinable', false,...
		'SpecIndex', i);
end
XSizeTmp = [0;0.0000000011;0;0;0.0000000066;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0.0000000047;0;0;0;0;0;0;0.0000000003;0.0000000035;0];
for i = 1:numberOfSpecs
	config.configParameter('X_Size',...
		'Value', XSizeTmp(i),...
		'LowerConstraint', XSizeTmp(i),...
		'UpperConstraint', 1,...
		'Refinable', false,...
		'SpecIndex', i);
end
YStrainTmp = [0.0006215203;0.0006628693;0.0006098238;0.0006995855;0.0007600822;0.0005947821;0.0006770953;0.0006218116;0.0006773564;0.0006518685;0.0008578998;0.0006504041;0.00074786;0.0005289788;0.000688056;0.0005168568;0.0003912947;0.0006946488;0.0004758251;0.0006797538;0.0004303192;0.0008600269;0.0008391786;0.0007675644;0.0002970585;0.0005165957;0.000338436;0.0004611191;0.0004207829;0.0000177596;0;0];
for i = 1:numberOfSpecs
	config.configParameter('Y_Strain',...
		'Value', YStrainTmp(i),...
		'LowerConstraint', YStrainTmp(i),...
		'UpperConstraint', 1,...
		'Refinable', false,...
		'SpecIndex', i);
end

% config.configParameter('P_Size',...
% 	'Value', 0.0476,...
% 	'LowerConstraint', 0.0476,...
% 	'UpperConstraint', 1,...
% 	'Refinable', false);
% config.configParameter('U_Strain',...
% 	'Value', 2.9491e-005,...
% 	'LowerConstraint', 2.9491e-005,...
% 	'UpperConstraint', 1,...
% 	'Refinable', false);
config.configParameter('V_Detector',...
	'Value', 0,...
	'LowerConstraint', 0,...
	'UpperConstraint', 1,...
	'Refinable', false);
% config.configParameter('X_Size',...
% 	'Value', 0.0050,...
% 	'LowerConstraint', 0.0050,...
% 	'UpperConstraint', 1,...
% 	'Refinable', false);
% config.configParameter('Y_Strain',...
% 	'Value', 1.8252e-004,...
% 	'LowerConstraint', 1.8252e-004,...
% 	'UpperConstraint', 1,...
% 	'Refinable', false);
config.configParameter('Z_Detector',...
	'Value', 0,...
	'LowerConstraint', 0,...
	'UpperConstraint', 1,...
	'Refinable', false);
config.configParameter('Background',...
	'Value', zeros(6,1),...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', true);
config.configParameter('MaxAmp',...
	'Value', [30; 55],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Center',...
	'Value', [14; 48],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Width',...
	'Value', [8; 29],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Shape1',...
	'Value', [3.2; 4.8],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Shape2',...
	'Value', [3.3; 7.9],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);

% out = fitter.executeFit(rc);