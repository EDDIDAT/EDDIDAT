%% Choice of scattering angle TwoTheta
config.configParameter('TwoTheta',...
	'Value', 16);

config.configParameter('LowerChannelBound',...
	'Value', 1500.3);

config.configParameter('UpperChannelBound',...
	'Value', 7400.3);

config.configParameter('DummyIntensity',...
	'Value', [0;0;0;0],...	%;0;0;0;0;0;0;0;0],...
	'LowerConstraint', 0,...
	'UpperConstraint', 10000,...
	'Refinable', true);

config.configParameter('DummyMixingFactor',...
	'Value', [1;1;1;1],...	%;1;1;1;1;1;1;1;1],...
	'LowerConstraint', 0,...
	'UpperConstraint', 1,...
	'Refinable', false);

config.configParameter('DummyPosition',...
	'Value', [18.6; 25.2; 28.4; 34.8],...	%; 20.98; 29.67; 36.34; 41.96; 46.91; 51.39
	'LowerConstraint', [18.3; 24.9; 28.1; 34.5],...	%; 20.68; 29.37; 36.04; 41.66; 46.61; 51.09
	'UpperConstraint', [18.9; 25.5; 28.7; 35.1],...	%; 21.28; 29.97; 36.64; 42.26; 47.21; 51.69
	'Refinable', false);

config.configParameter('DummyWidth',...
	'Value', [0.1;0.1;0.1;0.1],...	%;0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1],...
	'LowerConstraint', 0,...
	'UpperConstraint', 1,...
	'Refinable', false);

% TwoThetaTmp = [20];
% for i = 1:numberOfSpecs
% 	config.configParameter('TwoTheta',...
% 		'Value', TwoThetaTmp(i),...
% 		'SpecIndex', i);
% end

psiTmp = [0;4;8;12;16;20;24;28;32;36;40;44;48;52;56;60;64;68;72;74;76;78;80;81;82;83;84;85;86;87;88;89]; %0;4;8;12;16;20;24;28;32;36;40;44;48;52;56;60;64;68;72;74;76;78;80;81;82;83;84;85;86;87;88;89];
for i = 1:numberOfSpecs
	config.configParameter('Psi',...
		'Value', psiTmp(i),...
		'SpecIndex', i);
end

%% Input of photon energies of principal K-, L-shell emmision lines
config.configParameter('FluorPos_K',...
	'Value', [8.4; 11.3]);
config.configParameter('FluorPos_L',...
	'Value', [9.7; 9.96]);
config.configParameter('FluorInt_K',...
	'Value', [1; 0.5]);
config.configParameter('FluorInt_L',...
	'Value', [1; 0.7]);

%% Input of the h k l values and multiplicity m values
hklTmp = [%1 1 1 8;...
    2 0 0 6;...
    2 2 0 12;...
% % %     3 1 1 24;...
    2 2 2 8;...
	4 0 0 6;...
% % %     3 3 1 24;...
    4 2 0 24;...
    4 2 2 24];
config.configParameter('H',...
	'Value', hklTmp(:,1));
config.configParameter('K',...
	'Value', hklTmp(:,2));
config.configParameter('L',...
	'Value', hklTmp(:,3));
config.configParameter('Multiplicity',...
	'Value', hklTmp(:,4));
config.configParameter('Alpha',...
	'Value', 90);
config.configParameter('Beta',...
	'Value', 90);
config.configParameter('Gamma',...
	'Value', 90);

config.configParameter('RingCurrent',...
	'Value', 300);

% ringCurrentTmp = [300];
% for i = 1:numberOfSpecs
% 	config.configParameter('RingCurrent',...
% 		'Value', ringCurrentTmp(i),...
% 		'SpecIndex', i);
% end

% config.configParameter('DeadTime',...
% 	'Value', 0.0625);

deadTimeTmp = [0.089722222;0.089583333;0.089583333;0.089722222;0.08875;0.088194444;...
	0.088055556;0.0875;0.086388889;0.083888889;0.082638889;0.079305556;0.075138889;...
	0.070972222;0.065833333;0.060833333;0.055833333;0.050694444;0.046111111;0.04375;...
	0.041666667;0.038888889;0.036666667;0.035833333;0.034722222;0.03375;0.0325;...
	0.031805556;0.031111111;0.030833333;0.029861111;0.029444444];

for i = 1:numberOfSpecs
	config.configParameter('DeadTime',...
		'Value', deadTimeTmp(i),...
		'SpecIndex', i);
end

%% Input of the DEK values
DEK_S_Tmp = [-1.27e-006 5.80e-006;  %110
            -1.90e-006 7.70e-006; %200
            -1.27e-006 5.80e-006; %211
            -1.27e-006 5.80e-006; %220
            -1.67e-006 7.02e-006; %310
%             -1.05e-006 5.17e-006; %222
% 			-1.67e-006 7.02e-006; %310
            -1.27e-006 5.80e-006]; %321
config.configParameter('DEK_S1',...
	'Value', DEK_S_Tmp(:,1));
config.configParameter('DEK_S2',...
	'Value', DEK_S_Tmp(:,2));

%% Input of the attenuation factors
config.configParameter('DensityAir',...
	'Value', 1.293e-003);
load(fullfile(rvpath,'data','Physics','Air_Absorption.mat'));
config.configParameter('X_airabsorption',...
	'Value', X_airabsorption);
config.configParameter('Y_airabsorption',...
	'Value', Y_airabsorption_en);
config.configParameter('DetectorDistance',...
	'Value', 110);

%% material absorption correction
config.configParameter('Density',...
	'Value', 3.58);
load(fullfile(rvpath,'data','Physics','MgO_absorption_FFAST.mat'));
config.configParameter('X_abs',...
	'Value', X_abs);
config.configParameter('Y_abs',...
	'Value', Y_abs);

%% structure factor calculation
load(fullfile(rvpath,'data','Physics','AtomSF.mat'))
config.configParameter('SF_a',...
	'Value', [Atomdata(19,[1 3 5 7]); Atomdata(12,[1 3 5 7])]);
config.configParameter('SF_b',...
	'Value', [Atomdata(19,[2 4 6 8]); Atomdata(12,[2 4 6 8])]);
config.configParameter('SF_c',...
	'Value', [Atomdata(19,9); Atomdata(12,9)]);
config.configParameter('APConst',...
	'Value', [0 0 0;...
			  0 1/2 1/2;...
			  1/2 0 1/2;...
			  1/2 1/2 0;...
			  1/2 1/2 1/2;...
			  1/2 0 0;...
			  0 1/2 0;...
			  0 0 1/2]);
config.configParameter('APFitPattern',...
	'Value', [0 0 0;...
			  0 0 0;...
			  0 0 0;...
			  0 0 0;...
			  0 0 0;...
			  0 0 0;...
			  0 0 0;...
			  0 0 0]);
config.configParameter('APFitParams',...
	'Value', 0);
config.configParameter('AtomCoordCnts',...
	'Value', [4; 4]);

%% FitParameter for the FWHM and the line position calibration
config.configParameter('FluorScaleFactor_K',...
	'Value', 1,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorScaleFactor_L',...
	'Value', 1,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorDeltaEnergy_K',...
	'Value', zeros(3,1),...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorDeltaEnergy_L',...
	'Value', zeros(3,1),...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorU_K',...
	'Value', 0.0025,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorW_K',...
	'Value', 0.0005,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorU_L',...
	'Value', 0.0025,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('FluorW_L',...
	'Value', 0.0005,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);

%% Escape peaks
% config.configParameter('EscapeInt_Alpha',...
% 	'Value', ones(3,1));
% config.configParameter('EscapeInt_Beta',...
% 	'Value', ones(3,1));
% config.configParameter('EscapeAlphaInd',...
% 	'Value', [2; 3; 4]);
% config.configParameter('EscapeBetaInd',...
% 	'Value', [2; 3; 4]);
% config.configParameter('EscapeScaleFactor_Alpha',...
% 	'Value', 1,...
% 	'LowerConstraint', 0,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeScaleFactor_Beta',...
% 	'Value', 1,...
% 	'LowerConstraint', 0,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeU_Alpha',...
% 	'Value', 0.0025,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeU_Beta',...
% 	'Value', 0.0005,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeW_Alpha',...
% 	'Value', 0.0025,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
% config.configParameter('EscapeW_Beta',...
% 	'Value', 0.0005,...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);

%% Phase
config.configParameter('ScaleFactor',...
	'Value', 1,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', true);
config.configParameter('StructureFactor',...
	'Value', ones(6,1).*100,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('DeltaEnergy_a',...
	'Value', 0,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('DeltaEnergy_b',...
	'Value',  0,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('DeltaEnergy_c',...
	'Value', 0,...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('LatticeParam1',...
	'Value', 4.246,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('LatticeParam2',...
	'Value', 0,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
config.configParameter('LatticeParam3',...
	'Value', 0,...
	'LowerConstraint', 0,...
	'UpperConstraint', +Inf,...
	'Refinable', false);
% config.configParameter('StressCoef',...
% 	'Value', [0; 0; 0],...
% 	'LowerConstraint', -Inf,...
% 	'UpperConstraint', +Inf,...
% 	'Refinable', false);
config.configParameter('P_Size',...
	'Value', [0.0276603932],... 
	'LowerConstraint', [0.0276603932],...
	'UpperConstraint', [2],...
	'Refinable', false);
config.configParameter('P_Size_Instr',...
	'Value', [0.0276603932],... 
	'LowerConstraint', [0.0276603932],...
	'UpperConstraint', [2],...
	'Refinable', false);
config.configParameter('U_Strain',...
	'Value', [0.0001241635],... 
	'LowerConstraint', [0.0001241635],...
	'UpperConstraint', [1],...
	'Refinable', false);
config.configParameter('V_Detector',...
	'Value', 0,...
	'LowerConstraint', 0,...
	'UpperConstraint', 1,...
	'Refinable', false);
config.configParameter('X_Size',...
	'Value', [0],...
	'LowerConstraint', [0],...
	'UpperConstraint', [1],...
	'Refinable', false);
config.configParameter('X_Size_Instr',...
	'Value', [0],...
	'LowerConstraint', [0],...
	'UpperConstraint', [1],...
	'Refinable', false);
config.configParameter('Y_Strain',...
	'Value', [0.0024437191],...
	'LowerConstraint', [0.0024437191],...
	'UpperConstraint', [1],...
	'Refinable', false);
config.configParameter('Z_Detector',...
	'Value', 0,...
	'LowerConstraint', 0,...
	'UpperConstraint', 1,...
	'Refinable', false);
config.configParameter('Background',...
	'Value', zeros(5,1),...
	'LowerConstraint', -Inf,...
	'UpperConstraint', +Inf,...
	'Refinable', true);
config.configParameter('MaxAmp',...
	'Value', [60; 30],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Center',...
	'Value', [28; 45],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Width',...
	'Value', [20; 20],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Shape1',...
	'Value', [1.6; 1.6],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);
config.configParameter('Shape2',...
	'Value', [6.3; 6.3],...
	'LowerConstraint', 0,...
	'UpperConstraint', Inf,...
	'Refinable', false);

% out = fitter.executeFit(rc);